define("mockup-patterns-autotoc",["jquery","pat-base"],function(r,t){"use strict";return t.extend({name:"autotoc",trigger:".pat-autotoc",parser:"mockup",defaults:{section:"section",levels:"h1,h2,h3",IDPrefix:"autotoc-item-",classTOCName:"autotoc-nav",classSectionName:"autotoc-section",classLevelPrefixName:"autotoc-level-",classActiveName:"active",scrollDuration:"slow",scrollEasing:"swing"},init:function(){var o=this;o.$toc=r("<nav/>").addClass(o.options.classTOCName),o.options.prependTo?o.$toc.prependTo(o.options.prependTo):o.options.appendTo?o.$toc.appendTo(o.options.appendTo):o.$toc.prependTo(o.$el),o.options.className&&o.$el.addClass(o.options.className),r(o.options.section,o.$el).addClass(o.options.classSectionName);var a=o.$el.hasClass("autotabs"),n=null;r(o.options.levels,o.$el).each(function(t){var i=r(this),e=(i.prop("id")?i:i.parents(o.options.section)).prop("id");(!e||0<r("#"+e).length)&&(e=o.options.IDPrefix+o.name+"-"+t),null===(n=window.location.hash==="#"+e?e:n)&&i.hasClass(o.options.classActiveName)&&(n=e),i.data("navref",e),r("<a/>").appendTo(o.$toc).text(i.text()).attr("id",e).attr("href","#"+e).addClass(o.options.classLevelPrefixName+o.getLevel(i)).on("click",function(t,e){t.stopPropagation(),t.preventDefault(),e=e||{doScroll:!0,skipHash:!1};var n=r(this);o.$toc.children("."+o.options.classActiveName).removeClass(o.options.classActiveName),o.$el.children("."+o.options.classActiveName).removeClass(o.options.classActiveName),r(t.target).addClass(o.options.classActiveName),i.parents(o.options.section).addClass(o.options.classActiveName),!1!==e.doScroll&&o.options.scrollDuration&&i&&!a&&r("body,html").animate({scrollTop:i.offset().top},o.options.scrollDuration,o.options.scrollEasing),0!==o.$el.parents(".plone-modal").size()&&o.$el.trigger("resize.plone-modal.patterns"),r(this).trigger("clicked"),e.skipHash||window.history&&window.history.pushState&&window.history.pushState({},"","#"+n.attr("id"))}),i.data("autotoc-trigger-id",e)}),n?r("a#"+n).trigger("click",{doScroll:!0,skipHash:!0}):o.$toc.find("a").first().trigger("click",{doScroll:!1,skipHash:!0})},getLevel:function(n){var i=0;return r.each(this.options.levels.split(","),function(t,e){if(1===n.filter(e).size())return i=t+1,!1}),i}})}),define("mockup-utils",["jquery"],function(l){"use strict";function t(t){var n=this;return n.className="plone-loader",n.options=l.extend({},{backdrop:null,zIndex:10005},t=t||{}),n.init=function(){n.$el=l("."+n.className),0===n.$el.length&&(n.$el=l("<div><div></div></div>"),n.$el.addClass(n.className).hide().appendTo("body"))},n.show=function(t){n.init(),n.$el.show();var e=n.options.zIndex;"function"==typeof e?e=Math.max(e(),10005):(e=10005,l(".plone-modal-wrapper,.plone-modal-backdrop").each(function(){e=Math.max(e,l(this).css("zIndex")||10005)}),e+=1),n.$el.css("zIndex",e),void 0===t&&(t=!0),n.options.backdrop&&(n.options.backdrop.closeOnClick=t,n.options.backdrop.closeOnEsc=t,n.options.backdrop.init(),n.options.backdrop.show())},n.hide=function(){n.init(),n.$el.hide()},n}function i(t){return(t=void 0===t?"id":t)+Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var e={get:function(t){if(window.localStorage){t=window.localStorage[t];return"string"==typeof t?JSON.parse(t):void 0}},set:function(t,e){window.localStorage&&(window.localStorage[t]=JSON.stringify(e))}};return{bool:function(t){return"string"==typeof t&&(t=l.trim(t).toLowerCase()),-1===["false",!1,"0",0,"",void 0,null].indexOf(t)},escapeHTML:function(t){return l("<div/>").text(t).html()},removeHTML:function(t){return t.replace(/<[^>]+>/gi,"")},featureSupport:{dragAndDrop:function(){return"draggable"in document.createElement("span")},fileApi:function(){return"undefined"!=typeof FileReader},history:function(){return!(!window.history||!window.history.pushState)}},generateId:i,getAuthenticator:function(){var t=l('input[name="_authenticator"]');return 0===t.length?0<(t=l('a[href*="_authenticator"]')).length?t.attr("href").split("_authenticator=")[1]:"":t.val()},getWindow:function(){var t=window;return t=t.parent!==window?t.parent:t},Loading:t,loading:new t,parseBodyTag:function(t){return l(/<body[^>]*>[^]*<\/body>/im.exec(t)[0].replace("<body","<div").replace("</body>","</div>")).eq(0).html()},QueryHelper:function(t){var s=this;return s.options=l.extend({},{pattern:null,vocabularyUrl:null,searchParam:"SearchableText",pathOperator:"plone.app.querystring.operation.string.path",attributes:["UID","Title","Description","getURL","portal_type"],batchSize:10,baseCriteria:[],sort_on:"is_folderish",sort_order:"reverse",pathDepth:1},t),s.pattern=s.options.pattern,void 0!==s.pattern&&null!==s.pattern||(s.pattern={browsing:!1,basePath:"/"}),s.options.url&&!s.options.vocabularyUrl?s.options.vocabularyUrl=s.options.url:s.pattern.vocabularyUrl&&(s.options.vocabularyUrl=s.pattern.vocabularyUrl),s.valid=Boolean(s.options.vocabularyUrl),s.getBatch=function(t){return{page:t||1,size:s.options.batchSize}},s.getCurrentPath=function(){var t=s.pattern,e=s.currentPath||t.currentPath,e=e="function"==typeof e?e():e;return e=e||(t.basePath||t.options.basePath||"/")},s.getCriterias=function(t,e){var n=[];return(e=l.extend({},{useBaseCriteria:!0,additionalCriterias:[]},e=void 0===e?{}:e)).useBaseCriteria&&(n=s.options.baseCriteria.slice(0)),t&&n.push({i:s.options.searchParam,o:"plone.app.querystring.operation.string.contains",v:t+="*"}),e.searchPath?n.push({i:"path",o:s.options.pathOperator,v:e.searchPath+"::"+s.options.pathDepth}):s.pattern.browsing&&n.push({i:"path",o:s.options.pathOperator,v:s.getCurrentPath()+"::"+s.options.pathDepth}),n=n.concat(e.additionalCriterias)},s.getQueryData=function(t,e){t={query:JSON.stringify({criteria:s.getCriterias(t),sort_on:s.options.sort_on,sort_order:s.options.sort_order}),attributes:JSON.stringify(s.options.attributes)};return e&&(t.batch=JSON.stringify(s.getBatch(e))),t},s.getUrl=function(){var t=s.options.vocabularyUrl;return-1===t.indexOf("?")?t+="?":t+="&",t+l.param(s.getQueryData())},s.selectAjax=function(){return{url:s.options.vocabularyUrl,dataType:"JSON",quietMillis:100,data:function(t,e){return s.getQueryData(t,e)},results:function(t,e){e=10*e<t.total;return{results:t.results,more:e}}}},s.search=function(t,e,n,i,o,a){void 0===a&&(a="GET");var r=[];(r=(o=void 0===o?!0:o)?s.options.baseCriteria.slice(0):r).push({i:t,o:e,v:n});r={query:JSON.stringify({criteria:r}),attributes:JSON.stringify(s.options.attributes)};l.ajax({url:s.options.vocabularyUrl,dataType:"JSON",data:r,type:a,success:i})},s},setId:function(t,e){void 0===e&&(e="id");var n=void 0===(n=t.attr("id"))?i(e):n.replace(/\./g,"-");return t.attr("id",n),n},storage:e,createElementFromHTML:function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}}}),define("mockup-patterns-contentloader",["jquery","pat-base","pat-logger","pat-registry","mockup-utils","underscore"],function(i,t,e,o,a,r){"use strict";var s=e.getLogger("pat-contentloader");return t.extend({name:"contentloader",trigger:".pat-contentloader",parser:"mockup",defaults:{url:null,content:null,trigger:"click",target:null,template:null,dataType:"html"},init:function(){var e=this;"el"===e.options.url&&"A"===e.$el[0].tagName&&(e.options.url=e.$el.attr("href")),e.$el.removeClass("loading-content"),e.$el.removeClass("content-load-error"),"immediate"===e.options.trigger?e._load():e.$el.on(e.options.trigger,function(t){t.preventDefault(),e._load()})},_load:function(){this.$el.addClass("loading-content"),this.options.url?this.loadRemote():this.loadLocal()},loadRemote:function(){var n=this;i.ajax({url:n.options.url,dataType:n.options.dataType,success:function(t){var e;if("html"===n.options.dataType)-1!==t.indexOf("<html")&&(t=a.parseBodyTag(t)),e=i("<div>"+t+"</div>");else if(-1!==n.options.dataType.indexOf("json")){t.constructor===Array&&1===t.length&&(t=t[0]);try{e=i(r.template(n.options.template)(t))}catch(t){return n.$el.removeClass("loading-content"),n.$el.addClass("content-load-error"),void s.warn("error rendering template. pat-contentloader will not work")}}null!==n.options.content&&(e=e.find(n.options.content)),n.loadLocal(e)},error:function(){n.$el.removeClass("loading-content"),n.$el.addClass("content-load-error")}})},loadLocal:function(t){var e=this;if(!t&&null===e.options.content)return e.$el.removeClass("loading-content"),e.$el.addClass("content-load-error"),void s.warn("No selector configured");var n=e.$el;if(null!==e.options.target&&0===(n=i(e.options.target)).size())return e.$el.removeClass("loading-content"),e.$el.addClass("content-load-error"),void s.warn("No target nodes found");(t=t||i(e.options.content).clone()).length?(t.show(),n.replaceWith(t),o.scan(t)):n.empty(),e.$el.removeClass("loading-content"),e.emit("loading-done")}})}),define("mockup-patterns-cookietrigger",["pat-base"],function(t){"use strict";return t.extend({name:"cookietrigger",trigger:".pat-cookietrigger",parser:"mockup",isCookiesEnabled:function(){var t;document.cookie="areYourCookiesEnabled=0";var e=document.cookie;return-1===e.indexOf("areYourCookiesEnabled=0")?0:(t="areYourCookiesEnabled=1",document.cookie=t,-1===(e=document.cookie).indexOf(t)?0:(document.cookie="areYourCookiesEnabled=; expires=Thu, 01-Jan-70 00:00:01 GMT",1))},showIfCookiesDisabled:function(){this.isCookiesEnabled()?this.$el.hide():this.$el.show()},init:function(){this.showIfCookiesDisabled()}})}),define("mockup-patterns-formautofocus",["jquery","pat-base"],function(e,t,n){"use strict";return t.extend({name:"formautofocus",trigger:".pat-formautofocus",parser:"mockup",defaults:{condition:"div.error",target:"div.error :input:not(.formTabs):visible:first",always:":input:not(.formTabs):visible:first"},init:function(){var t=this;(0!==e(t.options.condition,t.$el).size()?e(t.options.target,t.$el):e(t.options.always,t.$el)).focus()}})}),define("mockup-i18n",["jquery"],function(i){"use strict";return function(){var s=this;s.baseUrl=i("body").attr("data-i18ncatalogurl"),s.currentLanguage=i("html").attr("lang")||"en",1<s.currentLanguage.split("-").length&&(s.currentLanguage=s.currentLanguage.split("-")[0]+"_"+s.currentLanguage.split("-")[1].toUpperCase()),s.storage=null,s.catalogs={},s.ttl=864e5,Date.now||(Date.now=function(){return(new Date).valueOf()});try{"localStorage"in window&&null!==window.localStorage&&"JSON"in window&&null!==window.JSON&&(s.storage=window.localStorage)}catch(t){}s.configure=function(t){for(var e in t)s[e]=t[e]},s._setCatalog=function(t,e,n){t in s.catalogs||(s.catalogs[t]={}),s.catalogs[t][e]=n},s._storeCatalog=function(t,e,n){e=t+"-"+e;null!==s.storage&&null!==n&&(s.storage.setItem(e,JSON.stringify(n)),s.storage.setItem(e+"-updated",Date.now()))},s.getUrl=function(t,e){return s.baseUrl+"?domain="+t+"&language="+e},s.loadCatalog=function(e,n){if(void 0===n&&(n=s.currentLanguage),null!==s.storage){var t=e+"-"+n;if(t in s.storage&&Date.now()-parseInt(s.storage.getItem(t+"-updated"),10)<s.ttl){t=JSON.parse(s.storage.getItem(t));return void s._setCatalog(e,n,t)}}s.baseUrl&&i.getJSON(s.getUrl(e,n),function(t){null!==t&&(s._setCatalog(e,n,t),s._storeCatalog(e,n,t))})},s.MessageFactory=function(a,r){return r=r||s.currentLanguage,function(t,e){var n,i,o=a in s.catalogs&&r in s.catalogs[a]&&t in s.catalogs[a][r]?s.catalogs[a][r][t]:t;if(e)for(i in e)e.hasOwnProperty(i)&&(n=new RegExp("\\$\\{"+i+"\\}","g"),o=o.replace(n,e[i]));return o}}}}),define("translate",["mockup-i18n"],function(i){"use strict";var o=null;return function(t,e){var n;return null===o&&((n=new i).loadCatalog("widgets"),o=n.MessageFactory("widgets")),o(t,e)}}),define("mockup-patterns-formunloadalert",["jquery","pat-base","translate"],function(o,t,e){"use strict";return t.extend({name:"formunloadalert",trigger:".pat-formunloadalert",parser:"mockup",_changed:!1,_suppressed:!1,defaults:{message:e("Discard changes? If you click OK, any changes you have made will be lost."),changingEvents:"change keyup paste",changingFields:"input,select,textarea,fileupload"},init:function(){var n,i=this;i.$el.is("form")&&(o(i.options.changingFields,i.$el).on(i.options.changingEvents,function(t){i._changed=!0}),0!==(n=i.$el.parents(".plone-modal")).size()?n.data("patternPloneModal").on("hide",function(t){var e=n.data("patternPloneModal");e&&(e._suppressHide=i._handleUnload.call(i,t))}):o(window).on("beforeunload",function(t){return i._handleUnload(t)}),i.$el.on("submit",function(t){i._suppressed=!0}))},_handleUnload:function(t){var e=this;if(e._suppressed)e._suppressed=!1;else if(e._changed){var n=e.options.message;return e._handleMsg(t,n),o(window).trigger("messageset"),n}},_handleMsg:function(t,e){(t||window.event).returnValue=e}})}),define("mockup-patterns-livesearch",["jquery","pat-base","underscore","translate"],function(a,t,r,s){"use strict";return t.extend({name:"livesearch",trigger:".pat-livesearch",parser:"mockup",timeout:null,active:!1,results:null,selectedItem:-1,resultsClass:"livesearch-results",defaults:{ajaxUrl:null,defaultSortOn:"",perPage:7,quietMillis:350,minimumInputLength:4,inputSelector:'input[type="text"]',itemTemplate:'<li class="search-result <%- state %>"><h4 class="title"><a href="<%- url %>"><%- title %></a></h4><p class="description"><%- description %></p></li>'},doSearch:function(e){var i=this;i.active=!0,i.render(),i.$el.addClass("searching");var n=i.$el.serialize();void 0===e&&(e=1);var t=function(){var t=location.search,e=t.indexOf("sort_on");if(-1===e){var n=a("#search-results");return 0<n.length?n.attr("data-default-sort"):i.options.defaultSortOn}e=t.substring(e);return e=(e=e.split("&")[0]).split("=")[1]}();a.ajax({url:i.options.ajaxUrl+"?"+n+"&page="+e+"&perPage="+i.options.perPage+"&sort_on="+t,dataType:"json"}).done(function(t){i.results=t,i.page=e,n!==i.$el.serialize()&&i.doSearch()}).fail(function(){i.results={items:[{url:"",title:s("Error"),description:s("There was an error searching…"),state:"error",error:!1}],total:1},i.page=1}).always(function(){i.active=!1,i.selectedItem=-1,i.$el.removeClass("searching"),i.render()})},render:function(){var i,t,e,n,o=this;o.$results.empty(),o.active?o.$results.append(a('<li class="searching">'+s("searching…")+"</li>")):null===o.results?o.$results.append(a('<li class="no-results no-search">'+s("enter search phrase")+"</li>")):0===o.results.total?o.$results.append(a('<li class="no-results">'+s("no results found")+"</li>")):o.$results.append(a('<li class="results-summary">'+s("found")+" "+o.results.total+" "+s("results")+"</li>")),null!==o.results&&(i=r.template(o.options.itemTemplate),r.each(o.results.items,function(t,e){var n=a(i(a.extend({_t:s},t)));n.attr("data-url",t.url).on("click",function(){t.error||(window.location=t.url)}),e===o.selectedItem&&n.addClass("selected"),o.$results.append(n)}),t=[],1<o.page&&((e=a('<a href="#" class="prev">'+s("Previous")+"</a>")).click(function(t){o.disableHiding=!0,t.preventDefault(),o.doSearch(o.page-1)}),t.push(e)),o.page*o.options.perPage<o.results.total&&((n=a('<a href="#" class="next">'+s("Next")+"</a>")).click(function(t){o.disableHiding=!0,t.preventDefault(),o.doSearch(o.page+1)}),t.push(n)),0<t.length&&((n=a('<li class="load-more"><div class="page">'+o.page+"</div></li>")).prepend(t),o.$results.append(n))),o.position()},position:function(){var t=this;t.$el.addClass("livesearch-active");var e=t.$input.position();t.$results.width(t.$el.outerWidth()),t.$results.css({top:e.top+t.$input.outerHeight(),left:e.left}),t.$results.show()},hide:function(){this.$results.hide(),this.$el.removeClass("livesearch-active")},init:function(){var e=this;e.$input=e.$el.find(e.options.inputSelector),e.$input.off("focusout").on("focusout",function(){setTimeout(function(){e.disableHiding?(e.disableHiding=!1,e.$input.focus()):e.hide()},200)}).off("focusin").on("focusin",function(){e.onceFocused?e.$results.is(":visible")||e.render():(e.onceFocused=!0,e.$input.val().length>=e.options.minimumInputLength&&e.doSearch())}).attr("autocomplete","off").off("keyup").on("keyup",function(t){t=t.keyCode||t.which;if(27===t)return e.$input.val(""),void e.hide();if(e.results&&e.results.items&&0<e.results.items.length){if(13===t)return void(-1!==e.selectedItem&&(window.location=e.results.items[e.selectedItem].url));if(38===t)return void(-1!==e.selectedItem&&(--e.selectedItem,e.render()));if(40===t)return void(e.selectedItem<e.results.items.length&&(e.selectedItem+=1,e.render()))}null!==e.timeout&&(clearTimeout(e.timeout),e.timeout=null),e.active||(e.$input.val().length>=e.options.minimumInputLength?e.timeout=setTimeout(function(){e.doSearch()},e.options.quietMillis):(e.results=null,e.render()))}),a("#sorting-options a").click(function(t){t.preventDefault(),e.onceFocused=!1}),e.$results=a('<ul class="'+e.resultsClass+'"></ul>').hide().insertAfter(e.$input)}})}),define("mockup-patterns-markspeciallinks",["pat-base","jquery"],function(t,r){"use strict";return t.extend({name:"markspeciallinks",trigger:".pat-markspeciallinks",parser:"mockup",defaults:{external_links_open_new_window:!1,mark_special_links:!0},init:function(){var t,e,n,i,o=this,a=o.$el;"string"==typeof o.options.external_links_open_new_window?t="true"===o.options.external_links_open_new_window.toLowerCase():"boolean"==typeof o.options.external_links_open_new_window&&(t=o.options.external_links_open_new_window),"string"==typeof o.options.mark_special_links?e="true"===o.options.mark_special_links.toLowerCase():"boolean"==typeof o.options.mark_special_links&&(e=o.options.mark_special_links),o=window.location.protocol+"//"+window.location.host,n=/^(mailto|ftp|news|irc|h323|sip|callto|https|feed|webcal)/,a=a,t&&a.find('a[href^="http"]:not(.link-plain):not([href^="'+o+'"])').attr("target","_blank").attr("rel","noopener"),e&&(a.find('a[href^="http:"]:not(.link-plain):not([href^="'+o+'"]):not(:has(img))').before('<i class="glyphicon link-external"></i>'),a.find('a[href]:not([href^="http:"]):not(.link-plain):not([href^="'+o+'"]):not(:has(img)):not([href^="#"])').each(function(){var t;(i=n.exec(r(this).attr("href")))&&(t="glyphicon link-"+i[0],r(this).before('<i class="'+t+'"></i>'))}))}})}),define("mockup-patterns-backdrop",["jquery","pat-base"],function(t,e){"use strict";return e.extend({name:"backdrop",trigger:".pat-backdrop",parser:"mockup",defaults:{zIndex:null,opacity:.8,className:"plone-backdrop",classActiveName:"plone-backdrop-active",closeOnEsc:!0,closeOnClick:!0},init:function(){var n=this;n.$backdrop=t("> ."+n.options.className,n.$el),0===n.$backdrop.size()&&(n.$backdrop=t("<div/>").hide().appendTo(n.$el).addClass(n.options.className),null!==n.options.zIndex&&n.$backdrop.css("z-index",n.options.zIndex)),!0===n.options.closeOnEsc&&t(document).on("keydown",function(t,e){n.$el.is("."+n.options.classActiveName)&&27===t.keyCode&&n.hide()}),!0===n.options.closeOnClick&&n.$backdrop.on("click",function(){n.$el.is("."+n.options.classActiveName)&&n.hide()})},show:function(){var t=this;t.$el.hasClass(t.options.classActiveName)||(t.emit("show"),t.$backdrop.css("opacity","0").show(),t.$el.addClass(t.options.classActiveName),t.$backdrop.animate({opacity:t.options.opacity},500),t.emit("shown"))},hide:function(){var t=this;t.$el.hasClass(t.options.classActiveName)&&(t.emit("hide"),t.$backdrop.animate({opacity:"0"},500).hide(),t.$el.removeClass(t.options.classActiveName),t.emit("hidden"))}})}),function(i,o){var t;"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(t,e,n){i.Backbone=o(i,n,t,e)}):"undefined"!=typeof exports?(t=require("underscore"),o(i,exports,t)):i.Backbone=o(i,{},i._,i.jQuery||i.Zepto||i.ender||i.$)}(this,function(t,r,x,e){var n=t.Backbone,i=[],o=i.slice;r.VERSION="1.1.2",r.$=e,r.noConflict=function(){return t.Backbone=n,this},r.emulateHTTP=!1,r.emulateJSON=!1;var a=r.Events={on:function(t,e,n){return d(this,"on",t,[e,n])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this})),this},once:function(t,e,n){if(!d(this,"once",t,[e,n])||!e)return this;var i=this,o=x.once(function(){i.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,n)},off:function(t,e,n){var i,o,a,r,s,l,c,u;if(!this._events||!d(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(s=0,l=(r=t?[t]:x.keys(this._events)).length;s<l;s++)if(t=r[s],a=this._events[t]){if(this._events[t]=i=[],e||n)for(c=0,u=a.length;c<u;c++)o=a[c],(e&&e!==o.callback&&e!==o.callback._callback||n&&n!==o.context)&&i.push(o);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!d(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&s(n,e),i&&s(i,arguments),this},stopListening:function(t,e,n){var i=this._listeningTo;if(!i)return this;var o,a=!e&&!n;for(o in n||"object"!=typeof e||(n=this),t&&((i={})[t._listenId]=t),i)(t=i[o]).off(e,n,this),(a||x.isEmpty(t._events))&&delete this._listeningTo[o];return this}},l=/\s+/,d=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(l.test(n)){for(var a=n.split(l),r=0,s=a.length;r<s;r++)t[e].apply(t,[a[r]].concat(i));return!1}return!0},s=function(t,e){var n,i=-1,o=t.length,a=e[0],r=e[1],s=e[2];switch(e.length){case 0:for(;++i<o;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=t[i]).callback.call(n.ctx,a);return;case 2:for(;++i<o;)(n=t[i]).callback.call(n.ctx,a,r);return;case 3:for(;++i<o;)(n=t[i]).callback.call(n.ctx,a,r,s);return;default:for(;++i<o;)(n=t[i]).callback.apply(n.ctx,e);return}};x.each({listenTo:"on",listenToOnce:"once"},function(i,t){a[t]=function(t,e,n){return((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=x.uniqueId("l"))]=t)[i](e,n=!n&&"object"==typeof e?this:n,this),this}}),a.bind=a.on,a.unbind=a.off,x.extend(r,a);var k=r.Model=function(t,e){var n=t||{};e=e||{},this.cid=x.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=x.defaults({},n,x.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};x.extend(k.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return x.clone(this.attributes)},sync:function(){return r.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return x.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,o,a,r,s,l,c;if(null==t)return this;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,!this._validate(o,n=n||{}))return!1;for(i in a=n.unset,s=n.silent,r=[],t=this._changing,this._changing=!0,t||(this._previousAttributes=x.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)e=o[i],x.isEqual(c[i],e)||r.push(i),x.isEqual(l[i],e)?delete this.changed[i]:this.changed[i]=e,a?delete c[i]:c[i]=e;if(!s){r.length&&(this._pending=n);for(var u=0,d=r.length;u<d;u++)this.trigger("change:"+r[u],this,c[r[u]],n)}if(t)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,x.extend({},e,{unset:!0}))},clear:function(t){var e,n={};for(e in this.attributes)n[e]=void 0;return this.set(n,x.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!x.isEmpty(this.changed):x.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&x.clone(this.changed);var e,n,i=!1,o=this._changing?this._previousAttributes:this.attributes;for(n in t)x.isEqual(o[n],e=t[n])||((i=i||{})[n]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return x.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?x.clone(e):{}).parse&&(e.parse=!0);var n=this,i=e.success;return e.success=function(t){if(!n.set(n.parse(t,e),e))return!1;i&&i(n,t,e),n.trigger("sync",n,t,e)},j(this,e),this.sync("read",this,e)},save:function(t,e,n){var i,o=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,n=x.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=x.extend({},o,i)),void 0===n.parse&&(n.parse=!0);var a=this,r=n.success;return n.success=function(t){a.attributes=o;var e=a.parse(t,n);if(n.wait&&(e=x.extend(i||{},e)),x.isObject(e)&&!a.set(e,n))return!1;r&&r(a,t,n),a.trigger("sync",a,t,n)},j(this,n),"patch"==(e=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=i),e=this.sync(e,this,n),i&&n.wait&&(this.attributes=o),e},destroy:function(e){e=e?x.clone(e):{};function n(){i.trigger("destroy",i,i.collection,e)}var i=this,o=e.success;if(e.success=function(t){(e.wait||i.isNew())&&n(),o&&o(i,t,e),i.isNew()||i.trigger("sync",i,t,e)},this.isNew())return e.success(),!1;j(this,e);var t=this.sync("delete",this,e);return e.wait||n(),t},url:function(){var t=x.result(this,"urlRoot")||x.result(this.collection,"url")||O();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},x.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=x.extend({},this.attributes,t);t=this.validationError=this.validate(t,e)||null;return!t||(this.trigger("invalid",this,t,x.extend(e,{validationError:t})),!1)}});x.each(["keys","values","pairs","invert","pick","omit"],function(e){k.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),x[e].apply(x,t)}});var c=r.Collection=function(t,e){(e=e||{}).model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,x.extend({silent:!0},e))},$={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1};x.extend(c.prototype,a,{model:k,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return r.sync.apply(this,arguments)},add:function(t,e){return this.set(t,x.extend({merge:!1},e,u))},remove:function(t,e){var n,i,o,a,r=!x.isArray(t);for(e=e||{},n=0,i=(t=r?[t]:x.clone(t)).length;n<i;n++)(a=t[n]=this.get(t[n]))&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a,e));return r?t[0]:t},set:function(t,e){(e=x.defaults({},e,$)).parse&&(t=this.parse(t,e));var n,i,o,a,r=!x.isArray(t);t=r?t?[t]:[]:x.clone(t);var s=e.at,l=this.model,c=this.comparator&&null==s&&!1!==e.sort,u=x.isString(this.comparator)?this.comparator:null,d=[],p=[],h={},f=e.add,m=e.merge,g=e.remove,v=!(c||!f||!g)&&[];for(b=0,w=t.length;b<w;b++){if(o=(i=t[b]||{})instanceof k?n=i:i[l.prototype.idAttribute||"id"],o=this.get(o))g&&(h[o.cid]=!0),m&&(i=i===n?n.attributes:i,e.parse&&(i=o.parse(i,e)),o.set(i,e),c&&!a&&o.hasChanged(u)&&(a=!0)),t[b]=o;else if(f){if(!(n=t[b]=this._prepareModel(i,e)))continue;d.push(n),this._addReference(n,e)}n=o||n,!v||!n.isNew()&&h[n.id]||v.push(n),h[n.id]=!0}if(g){for(b=0,w=this.length;b<w;++b)h[(n=this.models[b]).cid]||p.push(n);p.length&&this.remove(p,e)}if(d.length||v&&v.length)if(c&&(a=!0),this.length+=d.length,null!=s)for(b=0,w=d.length;b<w;b++)this.models.splice(s+b,0,d[b]);else{v&&(this.models.length=0);for(var y=v||d,b=0,w=y.length;b<w;b++)this.models.push(y[b])}if(a&&this.sort({silent:!0}),!e.silent){for(b=0,w=d.length;b<w;b++)(n=d[b]).trigger("add",n,this,e);(a||v&&v.length)&&this.trigger("sort",this,e)}return r?t[0]:t},reset:function(t,e){e=e||{};for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,x.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,x.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,x.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(n,t){return x.isEmpty(n)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var e in n)if(n[e]!==t.get(e))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t=t||{},x.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(x.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return x.invoke(this.models,"get",t)},fetch:function(n){void 0===(n=n?x.clone(n):{}).parse&&(n.parse=!0);var i=n.success,o=this;return n.success=function(t){var e=n.reset?"reset":"set";o[e](t,n),i&&i(o,t,n),o.trigger("sync",o,t,n)},j(this,n),this.sync("read",this,n)},create:function(t,n){if(n=n?x.clone(n):{},!(t=this._prepareModel(t,n)))return!1;n.wait||this.add(t,n);var i=this,o=n.success;return n.success=function(t,e){n.wait&&i.add(t,n),o&&o(t,e,n)},t.save(null,n),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof k)return t;t=new((e=e?x.clone(e):{}).collection=this).model(t,e);return t.validationError?(this.trigger("invalid",this,t.validationError,e),!1):t},_addReference:function(t,e){null!=(this._byId[t.cid]=t).id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});x.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],function(e){c.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),x[e].apply(x,t)}});x.each(["groupBy","countBy","sortBy","indexBy"],function(i){c.prototype[i]=function(e,t){var n=x.isFunction(e)?e:function(t){return t.get(e)};return x[i](this.models,n,t)}});var i=r.View=function(t){this.cid=x.uniqueId("view"),x.extend(this,x.pick(t=t||{},h)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},p=/^(\S+)\s*(.*)$/,h=["model","collection","el","id","attributes","className","tagName","events"];x.extend(i.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof r.$?t:r.$(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(!(t=t||x.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var n,i=t[e];(i=!x.isFunction(i)?this[t[e]]:i)&&(e=(n=e.match(p))[1],n=n[2],i=x.bind(i,this),e+=".delegateEvents"+this.cid,""===n?this.$el.on(e,i):this.$el.on(e,n,i))}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){var t;this.el?this.setElement(x.result(this,"el"),!1):(t=x.extend({},x.result(this,"attributes")),this.id&&(t.id=x.result(this,"id")),this.className&&(t.class=x.result(this,"className")),t=r.$("<"+x.result(this,"tagName")+">").attr(t),this.setElement(t,!1))}}),r.sync=function(t,e,n){var i=m[t];x.defaults(n=n||{},{emulateHTTP:r.emulateHTTP,emulateJSON:r.emulateJSON});var o,a={type:i,dataType:"json"};n.url||(a.url=x.result(e,"url")||O()),null!=n.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(n.attrs||e.toJSON(n))),n.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),!n.emulateHTTP||"PUT"!==i&&"DELETE"!==i&&"PATCH"!==i||(a.type="POST",n.emulateJSON&&(a.data._method=i),o=n.beforeSend,n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",i),o)return o.apply(this,arguments)}),"GET"===a.type||n.emulateJSON||(a.processData=!1),"PATCH"===a.type&&f&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});a=n.xhr=r.ajax(x.extend(a,n));return e.trigger("request",e,a,n),a};var f=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),m={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};r.ajax=function(){return r.$.ajax.apply(r.$,arguments)};var e=r.Router=function(t){(t=t||{}).routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},g=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,y=/\*\w+/g,b=/[\-{}\[\]+?.,\\\^$|#\s]/g;x.extend(e.prototype,a,{initialize:function(){},route:function(e,n,i){x.isRegExp(e)||(e=this._routeToRegExp(e)),x.isFunction(n)&&(i=n,n=""),i=i||this[n];var o=this;return r.history.route(e,function(t){t=o._extractParameters(e,t);o.execute(i,t),o.trigger.apply(o,["route:"+n].concat(t)),o.trigger("route",n,t),r.history.trigger("route",o,n,t)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,e){return r.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=x.result(this,"routes");for(var t,e=x.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(b,"\\$&").replace(g,"(?:$1)?").replace(v,function(t,e){return e?t:"([^/?]+)"}).replace(y,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return x.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var w=r.History=function(){this.handlers=[],x.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,S=/msie [\w.]+/,C=/\/$/,N=/#.*$/;w.started=!1,x.extend(w.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){t=(t||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(t,e){return null==t&&(this._hasPushState||!this._wantsHashChange||e?(t=decodeURI(this.location.pathname+this.location.search),e=this.root.replace(C,""),t.indexOf(e)||(t=t.slice(e.length))):t=this.getHash()),t.replace(_,"")},start:function(t){if(w.started)throw new Error("Backbone.history has already been started");w.started=!0,this.options=x.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment(),n=document.documentMode,t=S.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(T,"/"),t&&this._wantsHashChange&&(n=r.$('<iframe src="javascript:0" tabindex="-1">'),this.iframe=n.hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?r.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!t?r.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;e=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&e.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){r.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),w.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if((e=e===this.fragment&&this.iframe?this.getFragment(this.getHash(this.iframe)):e)===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),x.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!w.started)return!1;e&&!0!==e||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(N,""),this.fragment!==t){if(""===(this.fragment=t)&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){n?(n=t.href.replace(/(javascript:|#).*$/,""),t.replace(n+"#"+e)):t.hash="#"+e}}),r.history=new w;k.extend=c.extend=e.extend=i.extend=w.extend=function(t,e){var n=this,i=t&&x.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)};x.extend(i,n,e);e=function(){this.constructor=i};return e.prototype=n.prototype,i.prototype=new e,t&&x.extend(i.prototype,t),i.__super__=n.prototype,i};var O=function(){throw new Error('A "url" property or function must be specified')},j=function(e,n){var i=n.error;n.error=function(t){i&&i(e,t,n),e.trigger("error",e,t,n)}};return r}),define("mockup-router",["underscore","backbone"],function(r,t){"use strict";function s(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}return new(t.Router.extend({actions:[],redirects:{},addRoute:function(t,e,n,i,o,a){void 0===r.findWhere(this.patterns,{patternName:t,id:e})&&this.actions.push({patternName:t,id:e,callback:n,context:i,pathExp:o,expReplace:a});e=new RegExp("("+s(t)+":"+s(e)+")");this.route(e,"handleRoute")},addRedirect:function(t,e){this.redirects[t]=e},handleRoute:function(t){var e=t.split(":"),t=e[0],e=e[1],e=r.findWhere(this.actions,{patternName:t,id:e});e&&e.callback.call(e.context)},redirect:function(){var n,i,o,a=window.parent.location.pathname;if(r.some(this.actions,function(t){if(t.pathExp&&(i=new RegExp(t.pathExp),a.match(i))){o="!/"+t.patternName+":"+t.id;var e="";return t.expReplace&&(e=t.expReplace),n=a.replace(i,e),!0}},this),void 0===o)for(var t in this.redirects)if(i=new RegExp(t),a.match(i)){o="!/"+this.redirects[t],n=a.replace(i,"");break}void 0!==o&&this._changeLocation.apply(this,[n,o])},_changeLocation:function(t,e){window.parent.location.hash=e,window.parent.location.pathname=t},start:function(){t.history.start()},reset:function(){this.actions=[]}}))}),function(n){"function"==typeof define&&define.amd?define("jquery.form",["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,e){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(e),e}:n(jQuery)}(function(A){"use strict";var p=/\r?\n/g,g={};g.fileapi=void 0!==A('<input type="file">').get(0).files,g.formdata=void 0!==window.FormData;var D=!!A.fn.prop;function a(t){var e=t.data;t.isDefaultPrevented()||(t.preventDefault(),A(t.target).closest("form").ajaxSubmit(e))}function r(t){var e=t.target,n=A(e);if(!n.is("[type=submit],[type=image]")){var i=n.closest("[type=submit]");if(0===i.length)return;e=i[0]}var o=e.form;"image"===(o.clk=e).type&&(void 0!==t.offsetX?(o.clk_x=t.offsetX,o.clk_y=t.offsetY):"function"==typeof A.fn.offset?(n=n.offset(),o.clk_x=t.pageX-n.left,o.clk_y=t.pageY-n.top):(o.clk_x=t.pageX-e.offsetLeft,o.clk_y=t.pageY-e.offsetTop)),setTimeout(function(){o.clk=o.clk_x=o.clk_y=null},100)}function M(){var t;A.fn.ajaxSubmit.debug&&(t="[jquery.form] "+Array.prototype.join.call(arguments,""),window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t))}A.fn.attr2=function(){if(!D)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},A.fn.ajaxSubmit=function(N,t,e,n){if(!this.length)return M("ajaxSubmit: skipping submit process - no element selected"),this;var O,j=this;"function"==typeof N?N={success:N}:"string"==typeof N||!1===N&&0<arguments.length?(N={url:N,data:t,dataType:e},"function"==typeof n&&(N.success=n)):void 0===N&&(N={}),O=N.method||N.type||this.attr2("method"),n=(n=(n="string"==typeof(e=N.url||this.attr2("action"))?A.trim(e):"")||window.location.href||"")&&(n.match(/^([^#]+)/)||[])[1],N=A.extend(!0,{url:n,success:A.ajaxSettings.success,type:O||A.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},N);e={};if(this.trigger("form-pre-serialize",[this,N,e]),e.veto)return M("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(N.beforeSerialize&&!1===N.beforeSerialize(this,N))return M("ajaxSubmit: submit aborted via beforeSerialize callback"),this;n=N.traditional;void 0===n&&(n=A.ajaxSettings.traditional);var E=[],i=this.formToArray(N.semantic,E,N.filtering);if(N.data&&(c=A.isFunction(N.data)?N.data(i):N.data,N.extraData=c,c=A.param(c,n)),N.beforeSubmit&&!1===N.beforeSubmit(i,this,N))return M("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[i,this,N,e]),e.veto)return M("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;e=A.param(i,n);c&&(e=e?e+"&"+c:c),"GET"===N.type.toUpperCase()?(N.url+=(0<=N.url.indexOf("?")?"&":"?")+e,N.data=null):N.data=e;var a,o,r,s=[];N.resetForm&&s.push(function(){j.resetForm()}),N.clearForm&&s.push(function(){j.clearForm(N.includeHidden)}),!N.dataType&&N.target?(a=N.success||function(){},s.push(function(t,e,n){var i=arguments,o=N.replaceTarget?"replaceWith":"html";A(N.target)[o](t).each(function(){a.apply(this,i)})})):N.success&&(A.isArray(N.success)?A.merge(s,N.success):s.push(N.success)),N.success=function(t,e,n){for(var i=N.context||this,o=0,a=s.length;o<a;o++)s[o].apply(i,[t,e,n||j,j])},N.error&&(o=N.error,N.error=function(t,e,n){var i=N.context||this;o.apply(i,[t,e,n,j])}),N.complete&&(r=N.complete,N.complete=function(t,e){var n=N.context||this;r.apply(n,[t,e,j])});var l,n=0<A("input[type=file]:enabled",this).filter(function(){return""!==A(this).val()}).length,c="multipart/form-data",e=j.attr("enctype")===c||j.attr("encoding")===c,c=g.fileapi&&g.formdata;M("fileAPI :"+c),!1!==N.iframe&&(N.iframe||(n||e)&&!c)?N.closeKeepAlive?A.get(N.closeKeepAlive,function(){l=d(i)}):l=d(i):l=(n||e)&&c?function(t){for(var n=new FormData,e=0;e<t.length;e++)n.append(t[e].name,t[e].value);if(N.extraData){var i=function(t){var e,n,i=A.param(t,N.traditional).split("&"),o=i.length,a=[];for(e=0;e<o;e++)i[e]=i[e].replace(/\+/g," "),n=i[e].split("="),a.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return a}(N.extraData);for(e=0;e<i.length;e++)i[e]&&n.append(i[e][0],i[e][1])}N.data=null;var o=A.extend(!0,{},A.ajaxSettings,N,{contentType:!1,processData:!1,cache:!1,type:O||"POST"});N.uploadProgress&&(o.xhr=function(){var t=A.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){var e=0,n=t.loaded||t.position,i=t.total;t.lengthComputable&&(e=Math.ceil(n/i*100)),N.uploadProgress(t,n,i,e)},!1),t});o.data=null;var a=o.beforeSend;return o.beforeSend=function(t,e){N.formData?e.data=N.formData:e.data=n,a&&a.call(this,t,e)},A.ajax(o)}(i):A.ajax(N),j.removeData("jqxhr").data("jqxhr",l);for(var u=0;u<E.length;u++)E[u]=null;return this.trigger("form-submit-notify",[this,N]),this;function d(t){var e,n,c,u,d,p,h,f,m,a=j[0],g=A.Deferred();if(g.abort=function(t){h.abort(t)},t)for(n=0;n<E.length;n++)e=A(E[n]),D?e.prop("disabled",!1):e.removeAttr("disabled");(c=A.extend(!0,{},A.ajaxSettings,N)).context=c.context||c;var r="jqFormIO"+(new Date).getTime(),s=a.ownerDocument,l=j.closest("body");if(c.iframeTarget?(i=(d=A(c.iframeTarget,s)).attr2("name"))?r=i:d.attr2("name",r):(d=A('<iframe name="'+r+'" src="'+c.iframeSrc+'" />',s)).css({position:"absolute",top:"-1000px",left:"-1000px"}),p=d[0],h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var e="timeout"===t?"timeout":"aborted";M("aborting upload... "+e),this.aborted=1;try{p.contentWindow.document.execCommand&&p.contentWindow.document.execCommand("Stop")}catch(t){}d.attr("src",c.iframeSrc),h.error=e,c.error&&c.error.call(c.context,h,e,t),u&&A.event.trigger("ajaxError",[h,c,e]),c.complete&&c.complete.call(c.context,h,e)}},(u=c.global)&&0==A.active++&&A.event.trigger("ajaxStart"),u&&A.event.trigger("ajaxSend",[h,c]),c.beforeSend&&!1===c.beforeSend.call(c.context,h,c))return c.global&&A.active--,g.reject(),g;if(h.aborted)return g.reject(),g;(t=a.clk)&&(i=t.name)&&!t.disabled&&(c.extraData=c.extraData||{},c.extraData[i]=t.value,"image"===t.type&&(c.extraData[i+".x"]=a.clk_x,c.extraData[i+".y"]=a.clk_y));var v=1,y=2;function b(e){var n=null;try{e.contentWindow&&(n=e.contentWindow.document)}catch(t){M("cannot get iframe.contentWindow document: "+t)}if(n)return n;try{n=e.contentDocument||e.document}catch(t){M("cannot get iframe.contentDocument: "+t),n=e.document}return n}var t=A("meta[name=csrf-token]").attr("content"),i=A("meta[name=csrf-param]").attr("content");function o(){var t=j.attr2("target"),e=j.attr2("action"),n=j.attr("enctype")||j.attr("encoding")||"multipart/form-data";a.setAttribute("target",r),O&&!/post/i.test(O)||a.setAttribute("method","POST"),e!==c.url&&a.setAttribute("action",c.url),c.skipEncodingOverride||O&&!/post/i.test(O)||j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),c.timeout&&(m=setTimeout(function(){f=!0,_(v)},c.timeout));var i=[];try{if(c.extraData)for(var o in c.extraData)c.extraData.hasOwnProperty(o)&&(A.isPlainObject(c.extraData[o])&&c.extraData[o].hasOwnProperty("name")&&c.extraData[o].hasOwnProperty("value")?i.push(A('<input type="hidden" name="'+c.extraData[o].name+'">',s).val(c.extraData[o].value).appendTo(a)[0]):i.push(A('<input type="hidden" name="'+o+'">',s).val(c.extraData[o]).appendTo(a)[0]));c.iframeTarget||d.appendTo(l),p.attachEvent?p.attachEvent("onload",_):p.addEventListener("load",_,!1),setTimeout(function t(){try{var e=b(p).readyState;M("state = "+e),e&&"uninitialized"===e.toLowerCase()&&setTimeout(t,50)}catch(t){M("Server abort: ",t," (",t.name,")"),_(y),m&&clearTimeout(m),m=void 0}},15);try{a.submit()}catch(t){document.createElement("form").submit.apply(a)}}finally{a.setAttribute("action",e),a.setAttribute("enctype",n),t?a.setAttribute("target",t):j.removeAttr("target"),A(i).remove()}}i&&t&&(c.extraData=c.extraData||{},c.extraData[i]=t),c.forceSync?o():setTimeout(o,10);var w,x,k,$=50;function _(e){if(!h.aborted&&!k){if((x=b(p))||(M("cannot access response document"),e=y),e===v&&h)return h.abort("timeout"),void g.reject(h,"timeout");if(e===y&&h)return h.abort("server abort"),void g.reject(h,"error","server abort");if(x&&x.location.href!==c.iframeSrc||f){p.detachEvent?p.detachEvent("onload",_):p.removeEventListener("load",_,!1);var n,e="success";try{if(f)throw"timeout";var t="xml"===c.dataType||x.XMLDocument||A.isXMLDoc(x);if(M("isXml="+t),!t&&window.opera&&(null===x.body||!x.body.innerHTML)&&--$)return M("requeing onLoad callback, DOM not available"),void setTimeout(_,250);var i=x.body||x.documentElement;h.responseText=i?i.innerHTML:null,h.responseXML=x.XMLDocument||x,t&&(c.dataType="xml"),h.getResponseHeader=function(t){return{"content-type":c.dataType}[t.toLowerCase()]},i&&(h.status=Number(i.getAttribute("status"))||h.status,h.statusText=i.getAttribute("statusText")||h.statusText);var o,a,r,s=(c.dataType||"").toLowerCase(),l=/(json|script|text)/.test(s);l||c.textarea?(o=x.getElementsByTagName("textarea")[0])?(h.responseText=o.value,h.status=Number(o.getAttribute("status"))||h.status,h.statusText=o.getAttribute("statusText")||h.statusText):l&&(a=x.getElementsByTagName("pre")[0],r=x.getElementsByTagName("body")[0],a?h.responseText=a.textContent||a.innerText:r&&(h.responseText=r.textContent||r.innerText)):"xml"===s&&!h.responseXML&&h.responseText&&(h.responseXML=T(h.responseText));try{w=C(h,s,c)}catch(t){e="parsererror",h.error=n=t||e}}catch(t){M("error caught: ",t),e="error",h.error=n=t||e}h.aborted&&(M("upload aborted"),e=null),"success"===(e=h.status?200<=h.status&&h.status<300||304===h.status?"success":"error":e)?(c.success&&c.success.call(c.context,w,"success",h),g.resolve(h.responseText,"success",h),u&&A.event.trigger("ajaxSuccess",[h,c])):e&&(void 0===n&&(n=h.statusText),c.error&&c.error.call(c.context,h,e,n),g.reject(h,"error",n),u&&A.event.trigger("ajaxError",[h,c,n])),u&&A.event.trigger("ajaxComplete",[h,c]),u&&!--A.active&&A.event.trigger("ajaxStop"),c.complete&&c.complete.call(c.context,h,e),k=!0,c.timeout&&clearTimeout(m),setTimeout(function(){c.iframeTarget?d.attr("src",c.iframeSrc):d.remove(),h.responseXML=null},100)}}}var T=A.parseXML||function(t,e){return window.ActiveXObject?((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!==e.documentElement.nodeName?e:null},S=A.parseJSON||function(t){return window.eval("("+t+")")},C=function(t,e,n){var i=t.getResponseHeader("content-type")||"",o=("xml"===e||!e)&&0<=i.indexOf("xml"),t=o?t.responseXML:t.responseText;return o&&"parsererror"===t.documentElement.nodeName&&A.error&&A.error("parsererror"),"string"==typeof(t=n&&n.dataFilter?n.dataFilter(t,e):t)&&(("json"===e||!e)&&0<=i.indexOf("json")?t=S(t):("script"===e||!e)&&0<=i.indexOf("javascript")&&A.globalEval(t)),t};return g}},A.fn.ajaxForm=function(t,e,n,i){if(("string"==typeof t||!1===t&&0<arguments.length)&&(t={url:t,data:e,dataType:n},"function"==typeof i&&(t.success=i)),(t=t||{}).delegation=t.delegation&&A.isFunction(A.fn.on),t.delegation||0!==this.length)return t.delegation?(A(document).off("submit.form-plugin",this.selector,a).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,t,a).on("click.form-plugin",this.selector,t,r),this):this.ajaxFormUnbind().on("submit.form-plugin",t,a).on("click.form-plugin",t,r);var o={s:this.selector,c:this.context};return!A.isReady&&o.s?(M("DOM not ready, queuing ajaxForm"),A(function(){A(o.s,o.c).ajaxForm(t)})):M("terminating; zero elements found by selector"+(A.isReady?"":" (DOM not ready)")),this},A.fn.ajaxFormUnbind=function(){return this.off("submit.form-plugin click.form-plugin")},A.fn.formToArray=function(t,e,n){var i=[];if(0===this.length)return i;var o,a,r,s,l,c,u,d,p=this[0],h=this.attr("id"),f=(f=t||void 0===p.elements?p.getElementsByTagName("*"):p.elements)&&A.makeArray(f);if(!(f=h&&(t||/(Edge|Trident)\//.test(navigator.userAgent))&&(u=A(':input[form="'+h+'"]').get()).length?(f||[]).concat(u):f)||!f.length)return i;for(o=0,l=(f=A.isFunction(n)?A.map(f,n):f).length;o<l;o++)if((d=(s=f[o]).name)&&!s.disabled)if(t&&p.clk&&"image"===s.type)p.clk===s&&(i.push({name:d,value:A(s).val(),type:s.type}),i.push({name:d+".x",value:p.clk_x},{name:d+".y",value:p.clk_y}));else if((r=A.fieldValue(s,!0))&&r.constructor===Array)for(e&&e.push(s),a=0,c=r.length;a<c;a++)i.push({name:d,value:r[a]});else if(g.fileapi&&"file"===s.type){e&&e.push(s);var m=s.files;if(m.length)for(a=0;a<m.length;a++)i.push({name:d,value:m[a],type:s.type});else i.push({name:d,value:"",type:s.type})}else null!=r&&(e&&e.push(s),i.push({name:d,value:r,type:s.type,required:s.required}));return t||!p.clk||(d=(n=(u=A(p.clk))[0]).name)&&!n.disabled&&"image"===n.type&&(i.push({name:d,value:u.val()}),i.push({name:d+".x",value:p.clk_x},{name:d+".y",value:p.clk_y})),i},A.fn.formSerialize=function(t){return A.param(this.formToArray(t))},A.fn.fieldSerialize=function(o){var a=[];return this.each(function(){var t=this.name;if(t){var e=A.fieldValue(this,o);if(e&&e.constructor===Array)for(var n=0,i=e.length;n<i;n++)a.push({name:t,value:e[n]});else null!=e&&a.push({name:this.name,value:e})}}),A.param(a)},A.fn.fieldValue=function(t){for(var e=[],n=0,i=this.length;n<i;n++){var o=this[n],o=A.fieldValue(o,t);null==o||o.constructor===Array&&!o.length||(o.constructor===Array?A.merge(e,o):e.push(o))}return e},A.fieldValue=function(t,e){var n=t.name,i=t.type,o=t.tagName.toLowerCase();if((e=void 0===e?!0:e)&&(!n||t.disabled||"reset"===i||"button"===i||("checkbox"===i||"radio"===i)&&!t.checked||("submit"===i||"image"===i)&&t.form&&t.form.clk!==t||"select"===o&&-1===t.selectedIndex))return null;if("select"!==o)return A(t).val().replace(p,"\r\n");o=t.selectedIndex;if(o<0)return null;for(var a=[],r=t.options,s="select-one"===i,l=s?o+1:r.length,c=s?o:0;c<l;c++){var u=r[c];if(u.selected&&!u.disabled){var d=(d=u.value)||(u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value);if(s)return d;a.push(d)}}return a},A.fn.clearForm=function(t){return this.each(function(){A("input,select,textarea",this).clearFields(t)})},A.fn.clearFields=A.fn.clearInputs=function(n){var i=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,e=this.tagName.toLowerCase();i.test(t)||"textarea"===e?this.value="":"checkbox"===t||"radio"===t?this.checked=!1:"select"===e?this.selectedIndex=-1:"file"===t?/MSIE/.test(navigator.userAgent)?A(this).replaceWith(A(this).clone(!0)):A(this).val(""):n&&(!0===n&&/hidden/.test(t)||"string"==typeof n&&A(this).is(n))&&(this.value="")})},A.fn.resetForm=function(){return this.each(function(){var e=A(this),t=this.tagName.toLowerCase();switch(t){case"input":this.checked=this.defaultChecked;case"textarea":return this.value=this.defaultValue,!0;case"option":case"optgroup":var n=e.parents("select");return n.length&&n[0].multiple?"option"===t?this.selected=this.defaultSelected:e.find("option").resetForm():n.resetForm(),!0;case"select":return e.find("option").each(function(t){if(this.selected=this.defaultSelected,this.defaultSelected&&!e[0].multiple)return e[0].selectedIndex=t,!1}),!0;case"label":var i=A(e.attr("for")),n=e.find("input,select,textarea");return i[0]&&n.unshift(i[0]),n.resetForm(),!0;case"form":return"function"!=typeof this.reset&&("object"!=typeof this.reset||this.reset.nodeType)||this.reset(),!0;default:return e.find("form,input,label,select,textarea").resetForm(),!0}})},A.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},A.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var t=this.type;"checkbox"===t||"radio"===t?this.checked=e:"option"===this.tagName.toLowerCase()&&(t=A(this).parent("select"),e&&t[0]&&"select-one"===t[0].type&&t.find("option").selected(!1),this.selected=e)})},A.fn.ajaxSubmit.debug=!1}),define("mockup-patterns-modal",["jquery","underscore","pat-base","mockup-patterns-backdrop","pat-registry","mockup-router","mockup-utils","translate","jquery.form"],function(u,s,t,i,o,e,a,r){"use strict";return t.extend({name:"plone-modal",trigger:".pat-plone-modal",parser:"mockup",createModal:null,$model:null,defaults:{width:"",height:"",margin:20,position:"center middle",triggers:[],zIndexSelector:".plone-modal-wrapper,.plone-modal-backdrop",backdrop:"body",backdropOptions:{zIndex:"1040",opacity:"0.85",className:"plone-modal-backdrop",classActiveName:"plone-backdrop-active",closeOnEsc:!0,closeOnClick:!0},title:null,titleSelector:"h1:first",buttons:'.formControls > input[type="submit"], .formControls > button',content:"#content",automaticallyAddButtonActions:!0,loadLinksWithinModal:!0,prependContent:".portalMessage, #global_statusmessage",onRender:null,templateOptions:{className:"plone-modal fade",classDialog:"plone-modal-dialog",classModal:"plone-modal-content",classHeaderName:"plone-modal-header",classBodyName:"plone-modal-body",classFooterName:"plone-modal-footer",classWrapperName:"plone-modal-wrapper",classWrapperInnerName:"modal-wrapper-inner",classActiveName:"in",classPrependName:"",classContentName:"",template:'<div class="<%= options.className %>">  <div class="<%= options.classDialog %>">    <div class="<%= options.classModal %>">      <div class="<%= options.classHeaderName %>">        <a class="plone-modal-close">&times;</a>        <% if (title) { %><h2 class="plone-modal-title"><%= title %></h2><% } %>      </div>      <div class="<%= options.classBodyName %>">        <div class="<%= options.classPrependName %>"><%= prepend %></div>         <div class="<%= options.classContentName %>"><%= content %></div>      </div>      <div class="<%= options.classFooterName %>">         <% if (buttons) { %><%= buttons %><% } %>      </div>    </div>  </div></div>'},actions:{},actionOptions:{eventType:"click",disableAjaxFormSubmit:!1,target:null,ajaxUrl:null,modalFunction:null,isForm:!1,timeout:5e3,displayInModal:!0,reloadWindowOnClose:!0,error:".portalMessage.error, .alert-danger",formFieldError:".field.error",onSuccess:null,onError:null,onFormError:null,onTimeout:null,redirectOnResponse:!1,redirectToUrl:function(t,e,n){var i=/<body.*data-view-url=[\"'](.*)[\"'].*/im.exec(e);return i&&1<i.length||(i=/<body.*data-base-url=[\"'](.*)[\"'].*/im.exec(e))&&1<i.length?i[1].split('"')[0]:(i=/<base.*href=[\"'](.*)[\"'].*/im.exec(e))&&1<i.length?i[1]:""}},routerOptions:{id:null,pathExp:null},form:function(t){var a=this,r=a.$modal;a.options.automaticallyAddButtonActions&&(t[a.options.buttons]={}),t.a={},u.each(t,function(t,n){var e=s.union(s.keys(a.options.actionOptions),["templateOptions"]),i=u.extend(!0,{},a.options.actionOptions,s.pick(n,e));n.templateOptions=u.extend(!0,n.templateOptions,a.options.templateOptions);var e=s.union(s.keys(a.options.actionOptions),["actions","actionOptions"]),o=u.extend(!0,s.omit(n,e),a.options);u(t,u("."+n.templateOptions.classBodyName,r)).each(function(t){var e=u(this);e.on(i.eventType,function(t){t.stopPropagation(),t.preventDefault(),a.loading.show(!1),null!==i.modalFunction?a[i.modalFunction]():u.nodeName(e[0],"input")||u.nodeName(e[0],"button")||!0===n.isForm?a.options.handleFormAction.apply(a,[e,i,o]):null===n.ajaxUrl&&!u.nodeName(e[0],"a")||a.options.handleLinkAction.apply(a,[e,i,o])})})})},handleFormAction:function(o,a,r){var t,e,s=this,n={};if(n[o.attr("name")]=o.attr("value"),t=u.nodeName(o[0],"form")?o:o.parents("form:not(.disableAutoSubmit)"),e=null!==a.ajaxUrl?"function"==typeof a.ajaxUrl?a.ajaxUrl.apply(s,[o,a]):a.ajaxUrl:o.parents("form").attr("action"),a.disableAjaxFormSubmit)return o.attr("name")&&o.attr("value")&&t.append(u('<input type="hidden" name="'+o.attr("name")+'" value="'+o.attr("value")+'" />')),void t.trigger("submit");t.on("submit",function(t){t.preventDefault()}),t.trigger("submit"),s.loading.show(!1),t.ajaxSubmit({timeout:a.timeout,data:n,url:e,error:function(t,e,n){s.loading.hide(),"timeout"===e&&a.onTimeout?a.onTimeout.apply(s,t,n):a.onError?"string"==typeof a.onError?window[a.onError](t,e,n):a.onError(t,e,n):console.log("error happened",e," do something"),s.emit("formActionError",[t,e,n])},success:function(t,e,n,i){s.loading.hide(),0===u(a.error,t).size()&&0===u(a.formFieldError,t).size()?!0!==a.redirectOnResponse?(a.onSuccess&&("string"==typeof a.onSuccess?window[a.onSuccess](s,t,e,n,i):a.onSuccess(s,t,e,n,i)),!0===a.displayInModal?s.redraw(t,r):(o.trigger("destroy.plone-modal.patterns"),a.reloadWindowOnClose&&s.reloadWindow()),s.emit("formActionSuccess",[t,e,n,i])):"function"==typeof a.redirectToUrl?window.parent.location.href=a.redirectToUrl.apply(s,[o,t,a]):window.parent.location.href=a.redirectToUrl:a.onFormError?"string"==typeof a.onFormError?window[a.onFormError](s,t,e,n,i):a.onFormError(s,t,e,n,i):s.redraw(t,r)}})},handleLinkAction:function(t,i,o){var e,a=this;t.hasClass("pat-plone-modal")||(e=i.ajaxUrl?"function"==typeof i.ajaxUrl?i.ajaxUrl.apply(a,[t,i]):i.ajaxUrl:t.attr("href"),!1!==i.displayInModal?u.ajax({url:e}).fail(function(t,e,n){"timeout"===e&&i.onTimeout?i.onTimeout(a.$modal,t,n):i.onError?i.onError(t,e,n):window.alert(r("There was an error loading modal.")),a.emit("linkActionError",[t,e,n])}).done(function(t,e,n){a.redraw(t,o),i.onSuccess&&("string"==typeof i.onSuccess?window[i.onSuccess](a,t,e,n):i.onSuccess(a,t,e,n)),a.emit("linkActionSuccess",[t,e,n])}).always(function(){a.loading.hide()}):"_blank"===t.attr("target")?(window.open(e,"_blank"),a.loading.hide()):window.location=e)},render:function(t){var e,n,i,o=this;o.emit("before-render"),o.$raw&&(e=o.$raw.clone(),u("input:checked",e).each(function(){this.setAttribute&&this.setAttribute("checked","checked")}),n={title:"",prepend:"<div />",content:"",buttons:'<div class="pattern-modal-buttons"></div>',options:t.templateOptions},null===t.title?(i=u(t.titleSelector,e),n.title=i.html(),u(t.titleSelector,e).remove()):n.title=t.title,t.prependContent&&(n.prepend=u("<div />").append(u(t.prependContent,e).clone()).html(),u(t.prependContent,e).remove()),t.content?n.content=u(t.content,e).html():n.content=e.html(),o.$modal=u(s.template(o.options.templateOptions.template)(n)),o.$modalDialog=u("> ."+o.options.templateOptions.classDialog,o.$modal),o.$modalContent=u("> ."+o.options.templateOptions.classModal,o.$modalDialog),u("form",o.$modal).on("keydown",function(t){13===t.keyCode&&"TEXTAREA"!==t.target.nodeName&&(t.preventDefault(),u("input[type=submit], button[type=submit], button:not(type)",this).eq(0).trigger("click"))}),u(t.buttons,o.$modal).each(function(){var e=u(this);e.on("click",function(t){t.stopPropagation(),t.preventDefault()}).clone().appendTo(u(".pattern-modal-buttons",o.$modal)).off("click").on("click",function(t){t.stopPropagation(),t.preventDefault(),e.trigger("click")}),e.hide()}),o.emit("before-events-setup"),u(".plone-modal-header > a.plone-modal-close, .plone-modal-footer > a.plone-modal-close",o.$modal).off("click").on("click",function(t){t.stopPropagation(),t.preventDefault(),u(t.target).trigger("destroy.plone-modal.patterns")}),t.form&&t.form.apply(o,[t.actions]),o.$modal.addClass(o.options.templateOptions.className).on("destroy.plone-modal.patterns",function(t){t.stopPropagation(),o.hide()}).on("resize.plone-modal.patterns",function(t){t.stopPropagation(),t.preventDefault(),o.positionModal()}).appendTo(o.$wrapperInner),o.options.loadLinksWithinModal&&o.$modal.on("click",function(t){t.stopPropagation(),u.nodeName(t.target,"a")&&t.preventDefault(),o.$modal.trigger("modal-click")}),o.$modal.data("pattern-"+o.name,o),o.emit("after-render"),t.onRender&&("string"==typeof t.onRender?window[t.onRender](o):t.onRender(o)))}},reloadWindow:function(){window.parent.location.reload()},init:function(){var i=this;i.options.loadLinksWithinModal=u.parseJSON(i.options.loadLinksWithinModal),null!==i.options.routerOptions.id&&e.addRoute("modal",i.options.routerOptions.id,function(){this.show()},i,i.options.routerOptions.pathExp,i.options.routerOptions.expReplace),!0===i.options.backdropOptions.closeOnEsc&&u(document).on("keydown",function(t,e){i.$el.is("."+i.options.templateOptions.classActiveName)&&27===t.keyCode&&i.hide()}),u(window.parent).resize(function(){i.positionModal()}),i.options.triggers&&u.each(i.options.triggers,function(t,e){var n=e.substring(0,e.indexOf(" ")),e=e.substring(e.indexOf(" "),e.length);u(e||i.$el).on(n,function(t){t.stopPropagation(),t.preventDefault(),i.show()})}),i.$el.is("a")&&(i.$el.attr("href")&&!i.options.image&&(i.options.target||"#"!==i.$el.attr("href").substr(0,1)||(i.options.target=i.$el.attr("href"),i.options.content=""),i.options.ajaxUrl||"#"===i.$el.attr("href").substr(0,1)||(i.options.ajaxUrl=function(){return i.$el.attr("href")})),i.$el.on("click",function(t){t.stopPropagation(),t.preventDefault(),i.show()})),i.initModal()},createAjaxModal:function(){var o=this;o.emit("before-ajax"),o.loading.show();var t=o.options.ajaxUrl;"function"==typeof t&&(t=t.apply(o,[o.options])),o.ajaxXHR=u.ajax({url:t,type:o.options.ajaxType}).done(function(t,e,n){o.ajaxXHR=void 0,o.$raw=u("<div />").append(u(a.parseBodyTag(t))),o.emit("after-ajax",o,e,n),o._show()}).fail(function(t,e,n){var i=o.options.actionOptions;"timeout"===e&&i.onTimeout?i.onTimeout(o.$modal,t,n):i.onError?i.onError(t,e,n):(window.alert(r("There was an error loading modal.")),o.hide()),o.emit("linkActionError",[t,e,n])}).always(function(){o.loading.hide()})},createTargetModal:function(){this.$raw=u(this.options.target).clone(),this._show()},createBasicModal:function(){this.$raw=u("<div/>").html(this.$el.clone()),this._show()},createHtmlModal:function(){var t=u(this.options.html);this.$raw=t,this._show()},createImageModal:function(){var t=this;t.$wrapper.addClass("image-modal");var e=t.$el.attr("href"),n=t.$el.attr("data-modal-srcset")||"",i=u.trim(t.$el.context.innerText)||"Image";t.$raw=u("<div><h1>"+i+'</h1><div id="content"><div class="modal-image"><img src="'+e+'" srcset="'+n+'" /></div></div></div>'),t._show()},initModal:function(){var t=this;t.options.ajaxUrl?t.createModal=t.createAjaxModal:t.options.target?t.createModal=t.createTargetModal:t.options.html?t.createModal=t.createHtmlModal:t.options.image?t.createModal=t.createImageModal:t.createModal=t.createBasicModal},findPosition:function(t,e,n,i,o,a,r){var s,l,c={},u=l=s="auto";return"left"===t?(l=n+"px",c.left=l=a<i?"0px":l):"right"===t?(u=n+"px",c.right=u=a<i?"0px":u,c.left="auto"):(l=a/2-i/2-n+"px",c.left=l=a<i?"0px":l),"top"===e?(s=n+"px",c.top=s=r<o?"0px":s):"bottom"===e?(e=n+"px",c.bottom=e=r<o?"0px":e,c.top="auto"):(s=r/2-o/2-n+"px",c.top=s=r<o?"0px":s),c},modalInitialized:function(){return null!==this.$modal&&void 0!==this.$modal},positionModal:function(){var t=this;if(t.modalInitialized()){t.$modal.removeAttr("style"),t.$wrapper.parent().is("body")&&t.$wrapper.height(u(window.parent).height());var e="function"==typeof t.options.margin?t.options.margin():t.options.margin;t.$modal.css({position:"absolute",padding:e}),t.$modalDialog.css({margin:"0",padding:"0",width:t.options.width,height:t.options.height}),t.$modalContent.css({width:t.options.width});var n,i=t.options.position.split(" "),o=i[0],a=i[1],r=t.$modalDialog.outerWidth(!0),s=t.$modalDialog.outerHeight(!0),l=t.$wrapperInner.width(),i=t.$wrapperInner.height(),c=t.findPosition(o,a,e,r,s,l,i);for(n in c)t.$modalDialog.css(n,c[n])}},render:function(t){this.emit("render"),this.options.render.apply(this,[t]),this.emit("rendered")},show:function(){this.backdrop=this.createBackdrop(),this.createModal()},createBackdrop:function(){var e=this,n=new i(e.$el.parents(e.options.backdrop),e.options.backdropOptions),t=1041;return u(e.options.zIndexSelector).each(function(){t=Math.max(t,parseInt(u(this).css("zIndex"))+1||1041)}),e.$wrapper=u("<div/>").hide().css({"z-index":t,"overflow-y":"auto",position:"fixed",height:"100%",width:"100%",bottom:"0",left:"0",right:"0",top:"0"}).addClass(e.options.templateOptions.classWrapperName).insertBefore(n.$backdrop).on("click",function(t){e.options.backdropOptions.closeOnClick&&(t.stopPropagation(),t.preventDefault(),n.hide())}),n.on("hidden",function(t){void 0!==e.$modal&&e.$modal.hasClass(e.options.templateOptions.classActiveName)&&e.hide()}),e.loading=new a.Loading({backdrop:n}),e.$wrapperInner=u("<div/>").addClass(e.options.classWrapperInnerName).css({position:"absolute",bottom:"0",left:"0",right:"0",top:"0"}).appendTo(e.$wrapper),n},_show:function(){var t=this;t.render.apply(t,[t.options]),t.emit("show"),t.backdrop.show(),t.$wrapper.show(),t.loading.hide(),t.$el.addClass(t.options.templateOptions.classActiveName),t.$modal.addClass(t.options.templateOptions.classActiveName),o.scan(t.$modal),t.positionModal(),u(window.parent).on("resize.plone-modal.patterns",function(){t.positionModal()}),u("body").addClass("plone-modal-open"),t.emit("shown")},hide:function(){var t=this;t.ajaxXHR&&t.ajaxXHR.abort(),t.emit("hide"),t._suppressHide&&!window.confirm(t._suppressHide)||(t.loading.hide(),t.$el.removeClass(t.options.templateOptions.classActiveName),void 0!==t.$modal&&(t.$modal.remove(),t.initModal()),t.$wrapper.remove(),u(".plone-modal",u("body")).size()<1&&(t._suppressHide=void 0,t.backdrop.hide(),u("body").removeClass("plone-modal-open"),u(window.parent).off("resize.plone-modal.patterns")),t.emit("hidden"))},redraw:function(t,e){var n=this;n.emit("beforeDraw"),n.$modal.remove(),n.$raw=u("<div />").append(u(a.parseBodyTag(t))),n.render.apply(n,[e||n.options]),n.$modal.addClass(n.options.templateOptions.classActiveName),n.positionModal(),o.scan(n.$modal),n.emit("afterDraw")}})}),define("mockup-patterns-navigationmarker",["jquery","pat-base"],function(c,t){return t.extend({name:"navigationmarker",trigger:".pat-navigationmarker",parser:"mockup",init:function(){var l=document.querySelector('head link[rel="canonical"]').href||window.location.href;c("a",this.$el).each(function(){var t=this.href.replace("/view","");if(-1!==l.indexOf(t)){var e=c(this).parent(),n=e.find("> input");n.length&&(n[0].checked=!0);for(var i=l.split("/"),o=t.split("/"),a=!1,r=0,s=o.length;r<s;r++)a=!1,o[r]===i[r]&&(a=!0);a&&e.addClass("inPath"),l===t&&e.addClass("current")}})}})}),define("mockup-patterns-preventdoublesubmit",["jquery","pat-base","translate"],function(n,t,e){"use strict";return t.extend({name:"preventdoublesubmit",trigger:".pat-preventdoublesubmit",parser:"mockup",defaults:{message:e("You already clicked the submit button. Do you really want to submit this form again?"),guardClassName:"submitting",optOutClassName:"allowMultiSubmit"},init:function(){var e=this;e.$el.is("form")&&n(":submit",e.$el).click(function(t){return n(":submit").removeAttr("clicked"),n(this).attr("clicked","clicked"),n(this).hasClass(e.options.guardClassName)&&!n(this).hasClass(e.options.optOutClassName)?e._confirm.call(e):void n(this).addClass(e.options.guardClassName)})},_confirm:function(t){return window.confirm(this.options.message)}})}),require(["mockup-patterns-autotoc","mockup-patterns-contentloader","mockup-patterns-cookietrigger","mockup-patterns-formautofocus","mockup-patterns-formunloadalert","mockup-patterns-livesearch","mockup-patterns-markspeciallinks","mockup-patterns-modal","mockup-patterns-navigationmarker","mockup-patterns-preventdoublesubmit"],function(){}),define("/Users/alecmitchell/Development/egg-cache/plone.staticresources-1.4.2-py3.8.egg/plone/staticresources/static/plone.js",function(){});
//# sourceMappingURL=plone.min.js.map