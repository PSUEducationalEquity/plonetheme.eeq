[buildout]

parts +=
    npm-install
    theme-compile

[theme]
package_path = ${buildout:directory}
path = ${theme:package_path}/src/plonetheme/eeq/theme

[npm-install]
recipe = collective.recipe.cmd
on_install = true
on_update = false
cmds =
    NODE_PATH="" npm_config_cache="" npm install
    cd ${theme:path}
    NODE_PATH="" npm_config_cache="" npm install

[theme-compile]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
    NODE_PATH="" npm_config_cache="" npm update
    NODE_PATH="" npm_config_cache="" npm run compile
    cd ${theme:path}
    NODE_PATH="" npm_config_cache="" npm update
